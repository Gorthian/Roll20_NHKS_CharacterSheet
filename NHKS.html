<!--
	EDITED by 			Gorthian
	Version				0.1
	Letzte Änderung		2022-03-14
	
	GitHub				https://github.com/Gorthian/Roll20_NHKS_CharacterSheet
	Wiki				https://github.com/Gorthian/Roll20_NHKS_CharacterSheet/wiki
	Bugs & Issues		https://github.com/Gorthian/Roll20_NHKS_CharacterSheet/issues
//-->

<!-- Sheet //-->
<input type="hidden" class="sheet-tabstoggle" name="attr_sheetTab"  value="actor"  />
<div class="sheet-wrapper sheet-NHKS">
	<div class="sheet-menu">
		<button type="action" name="act_actor"><span data-i18n="actor"></span></button>
    	<button type="action" name="act_role"><span data-i18n="role"></span></button>
	</div>
	<div class="sheet-content">
		<div class="sheet-actor">
			<div class="sheet-actor-sheet">
				<div class="sheet-actor-attributes">
					<h1><span data-i18n="attributes-and-descriptions"></span></h1>
					<div class="sheet-actor-attributes-content">
						<div class="sheet-actor-attributes-left">
							<span class="sheet-input-line"><span class="sheet-label" data-i18n="name"></span><input type="text" name="attr_character_name" /></span>
							<span class="sheet-input-line"><span class="sheet-label" data-i18n="gender"></span><input type="text" name="attr_actor-gender" /></span>
							<span class="sheet-input-line"><span class="sheet-label" data-i18n="age"></span><input type="text" name="attr_actor-age" /></span>
							<span class="sheet-input-line"><span class="sheet-label" data-i18n="weight"></span><input type="text" name="attr_actor-weight" /></span>
							<span class="sheet-input-line"><span class="sheet-label" data-i18n="size"></span><input type="text" name="attr_actor-size" /></span>
							<span class="sheet-input-line"><span class="sheet-label" data-i18n="nationality"></span><input type="text" name="attr_actor-nationality" /></span>
							<p><span class="sheet-label" data-i18n="stature"></span><textarea name="attr_actor-stature" value=""></textarea></p>
							<p><span class="sheet-label" data-i18n="description"></span><textarea name="attr_actor-description" value=""></textarea></p>
							<div class="sheet-actor-attributes-values">
								<div class="sheet-actor-attr-kno sheet-input-line">
									<span class="sheet-label">
										<span class="sheet-attr-short" data-i18n="knowledge-short"></span><br/>
										<span class="sheet-attr-full" data-i18n="knowledge"></span>
									</span>
									<input class="sheet-attribute-value" type="number" name="attr_knowledge" />
								</div>
								<div class="sheet-actor-attr-str sheet-input-line">
									<span class="sheet-label">
										<span class="sheet-attr-short" data-i18n="strength-short"></span><br/>
										<span class="sheet-attr-full" data-i18n="strength"></span>
									</span>
									<input class="sheet-attribute-value" type="number" name="attr_strength" />
								</div>
								<div class="sheet-actor-attr-col sheet-input-line">
									<span class="sheet-label">
										<span class="sheet-attr-short" data-i18n="coolness-short"></span><br/>
										<span class="sheet-attr-full" data-i18n="coolness"></span>
									</span>
									<input class="sheet-attribute-value" type="number" name="attr_coolness" />
								</div>
								<div class="sheet-actor-attr-sta sheet-input-line">
									<span class="sheet-label">
										<span class="sheet-attr-short" data-i18n="stamina-short"></span><br/>
										<span class="sheet-attr-full" data-i18n="stamina"></span>
									</span>
									<input class="sheet-attribute-value" type="number" name="attr_stamina" />
								</div>
								<div class="sheet-actor-attr-chi sheet-input-line">
									<span class="sheet-label">
										<span class="sheet-attr-short" data-i18n="chi-short"></span><br/>
										<span class="sheet-attr-full" data-i18n="chi"></span>
									</span>
									<input class="sheet-attribute-value" type="number" name="attr_chi" />
								</div>
								<div class="sheet-actor-attr-dex sheet-input-line">
									<span class="sheet-label">
										<span class="sheet-attr-short" data-i18n="dexterity-short"></span><br/>
										<span class="sheet-attr-full" data-i18n="dexterity"></span>
									</span>
									<input class="sheet-attribute-value" type="number" name="attr_dexterity" />
								</div>
							</div>
						</div>
						<div class="sheet-actor-attributes-right">
							<div class="sheet-actor-attr-hitpoints sheet-input-line">
								<span class="sheet-attr-name" data-i18n="hitpoints"></span><br/>
								<span class="sheet-attr-desc" data-i18n="hitpoints-desc"></span><br/>								
								<input type="number" name="attr_hitpoints_current" /> / <input type="number" name="attr_hitpoints_max" class="sheet-no-arrows" READONLY />
							</div>
							<div class="sheet-actor-attr-chipoints sheet-input-line">
								<span class="sheet-attr-name" data-i18n="chipoints"></span><br/>
								<span class="sheet-attr-desc" data-i18n="chipoints-desc"></span><br/>							
								<input type="number" name="attr_chipoints_current" /> / <input type="number" name="attr_chipoints_max" class="sheet-no-arrows" READONLY />
							</div>
							<div class="sheet-actor-attr-famepoints sheet-input-line">
								<span class="sheet-attr-name" data-i18n="famepoints"></span><br/>
								<span class="sheet-attr-desc" data-i18n="famepoints-desc"></span><br/>
								<input type="number" name="attr_famepoints" />
							</div>
							<div class="sheet-actor-attr-awardpoints sheet-input-line">
								<span class="sheet-attr-name" data-i18n="awardpoints"></span><br/>
								<span class="sheet-attr-desc" data-i18n="awardpoints-desc"></span><br/>						
								<input type="number" name="attr_awardpoints" />
							</div>
							<div class="sheet-actor-attr-initiative sheet-input-line">
								<span class="sheet-attr-name" data-i18n="initiative"></span><br/>
								<span class="sheet-attr-desc" data-i18n="initiative-desc"></span><br/>						
								<input type="number" name="attr_initiative" class="sheet-no-arrows" READONLY />
							</div>
							<div class="sheet-actor-attr-melee-attack sheet-input-line">
								<span class="sheet-attr-name" data-i18n="melee-attack"></span><br/>
								<span class="sheet-attr-desc" data-i18n="melee-attack-desc"></span><br/>						
								<input type="number" name="attr_melee-attack" class="sheet-no-arrows" READONLY />
							</div>
							<div class="sheet-actor-attr-melee-defense sheet-input-line">
								<span class="sheet-attr-name" data-i18n="melee-defense"></span><br/>
								<span class="sheet-attr-desc" data-i18n="melee-defense-desc"></span><br/>							
								<input type="number" name="attr_melee-defense" class="sheet-no-arrows" READONLY />
							</div>							
							<div class="sheet-actor-attr-melee-damage sheet-input-line">
								<span class="sheet-attr-name" data-i18n="melee-damage"></span><br/>
								<span class="sheet-attr-desc" data-i18n="melee-damage-desc"></span><br/>						
								<input type="number" name="attr_melee-damage" class="sheet-no-arrows" READONLY />
							</div>
							<div class="sheet-actor-attr-ranged-attack sheet-input-line">
								<span class="sheet-attr-name" data-i18n="ranged-attack"></span><br/>
								<span class="sheet-attr-desc" data-i18n="ranged-attack-desc"></span><br/>							
								<input type="number" name="attr_ranged-attack" class="sheet-no-arrows" READONLY />
							</div>							
							<div class="sheet-actor-attr-ranged-damage sheet-input-line">
								<span class="sheet-attr-name" data-i18n="ranged-damage"></span><br/>
								<span class="sheet-attr-desc" data-i18n="ranged-damage-desc"></span><br/>							
								<input type="number" name="attr_ranged-damage" class="sheet-no-arrows" READONLY />
							</div>
						</div>						
					</div>
				</div>
				<div class="sheet-actor-skills">
					<h1><span data-i18n="skills"></span></h1>
					<table>
						<tr>
							<td>
								<span data-i18n="acrobatic"></span>
							</td>
							<td>
								<select name="attr_skill-athletic-attribute">
									<option value="dexterity" data-i18n="dexterity-short"></option>
								</select>
							</td>
							<td>
								<input type="number" name="attr_skill-acrobatic" />
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="athletic"></span>
							</td>
							<td>
								<select name="attr_skill-athletic-attribute">
									<option value="strength" data-i18n="strength-short"></option>
									<option value="stamina" data-i18n="stamina-short"></option>
								</select>
							</td>	
							<td>
								<input type="number" name="attr_skill-athletic" />
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="dodge"></span>
							</td>
							<td>
								<select name="attr_skill-dodge-attribute">
									<option value="dexterity" data-i18n="dexterity-short"></option>
								</select>
							</td>
							<td>
								<input type="number" name="attr_skill-dodge" />
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="boats"></span>
							</td>
							<td>
								<select name="attr_skill-boats-attribute">
									<option value="knowledge" data-i18n="knowledge-short"></option>
									<option value="dexterity" data-i18n="dexterity-short"></option>
								</select>
							</td>
							<td>
								<input type="number" name="attr_skill-boats"></span>
							</td>						
						</tr>
						<tr>
							<td>
								<span data-i18n="persuade"></span>
							</td>
							<td>
								<select name="attr_skill_persuade_attribute">
									<option value="coolness" data-i18n="coolness-short"></option>
									<option value="strength" data-i18n="strength-short"></option>
								</select>
							</td>
							<td>
								<input type="number" name="attr_skill_persuade"></span>
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="computers"></span>
							</td>
							<td>
								<select name="attr_skill-computers-attribute">
									<option value="knowledge" data-i18n="knowledge-short"></option>
								</select>
							</td>
							<td>
								<input type="number" name="attr_skill-computers"></span>
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="firstaid"></span>
							</td>
							<td>
								<select name="attr_skill-firstaid-attribute">
									<option value="knowledge" data-i18n="knowledge-short"></option>
								</select>
							</td>
							<td>
								<input type="number" name="attr_skill-firstaid"></span>
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="extremesport"></span>
							</td>
							<td>
								<select name="attr_skill-extremesport-attribute">
									<option value="strength" data-i18n="strength-short"></option>
									<option value="stamina" data-i18n="stamina-short"></option>
									<option value="dexterity" data-i18n="dexterity-short"></option>
								</select>
							</td>
							<td>
								<input type="number" name="attr_skill-extremesport"></span>
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="slideofhand"></span>
							</td>
							<td>
								<select name="attr_skill-slideofhand-attribute">
									<option value="dexterity" data-i18n="dexterity-short"></option>
								</select>
							</td>
							<td>
								<input type="number" name="attr_skill-slideofhand"></span>
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="aircrafts"></span>
							</td>
							<td>
								<select name="attr_skill-aircrafts-attribute">
									<option value="knowledge" data-i18n="knowledge-short"></option>
									<option value="dexterity" data-i18n="dexterity-short"></option>
								</select>
							</td>
							<td>
								<input type="number" name="attr_skill-aircrafts"></span>
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="vehicles"></span>
							</td>
							<td>
								<select name="attr_skill-vehicles-attribute">
									<option value="knowledge" data-i18n="knowledge-short"></option>
									<option value="dexterity" data-i18n="dexterity-short"></option>
								</select>
							</td>
							<td>
								<input type="number" name="attr_skill-vehicles"></span>
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="improvisation"></span>
							</td>
							<td>
								<select name="attr_skill-improvisation-attribute">
									<option value="knowledge" data-i18n="knowledge-short"></option>
									<option value="strength" data-i18n="strength-short"></option>
									<option value="coolness" data-i18n="coolness-short"></option>
									<option value="stamina" data-i18n="stamina-short"></option>
									<option value="chi" data-i18n="chi-short"></option>
									<option value="dexterity" data-i18n="dexterity-short"></option>
								</select>
							</td>
							<td>
								<input type="number" name="attr_skill-improvisation"></span>
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="climbing"></span>
							</td>
							<td>
								<select name="attr_skill-climbing-attribute">								
									<option value="strength" data-i18n="strength-short"></option>								
									<option value="stamina" data-i18n="stamina-short"></option>								
									<option value="dexterity" data-i18n="dexterity-short"></option>
								</select>
							</td>
							<td>
								<input type="number" name="attr_skill-climbing"></span>
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="contacts"></span>
							</td>
							<td>
								<select name="attr_skill-contacts-attribute">
									<option value="knowledge" data-i18n="knowledge-short"></option>
									<option value="coolness" data-i18n="coolness-short"></option>
								</select>
							</td>
							<td>
								<input type="number" name="attr_skill-contacts"></span>
							</td>							
						</tr>
						<tr>
							<td>
								<span data-i18n="mechanic"></span>
							</td>
							<td>
								<select name="attr_skill-mechanic-attribute">
									<option value="knowledge" data-i18n="knowledge-short"></option>
								</select>
							</td>
							<td>
								<input type="number" name="attr_skill-mechanic"></span>
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="stealth"></span>
							</td>
							<td>
								<select name="attr_skill-stealth-attribute">								
									<option value="dexterity" data-i18n="dexterity-short"></option>
								</select>
							</td>
							<td>
								<input type="number" name="attr_skill-stealth"></span>
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="perception"></span>
							</td>
							<td>
								<select name="attr_skill-perception-attribute">
									<option value="chi" data-i18n="chi-short"></option>
								</select>
							</td>
							<td>
								<input type="number" name="attr_skill-perception"></span>
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="languages"></span>
							</td>
							<td>
								<select name="attr_skill-languages-attribute">
									<option value="knowledge" data-i18n="knowledge-short"></option>
									<option value="coolness" data-i18n="coolness-short"></option>
								</select>
							</td>
							<td>
								<input type="number" name="attr_skill-languages"></span>
							</td>						
						</tr>
						<tr>
							<td>
								<span data-i18n="searching"></span>
							</td>
							<td>
								<select name="attr_skill-searching-attribute">
									<option value="knowledge" data-i18n="knowledge-short"></option>
									<option value="chi" data-i18n="chi-short"></option>
								</select>
							</td>
							<td>
								<input type="number" name="attr_skill-searching"></span>
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="hiding"></span>
							</td>
							<td>
								<select name="attr_skill-hiding-attribute">
									<option value="knowledge" data-i18n="knowledge-short"></option>								
									<option value="dexterity" data-i18n="dexterity-short"></option>
								</select>
							</td>
							<td>
								<input type="number" name="attr_skill-hiding"></span>
							</td>
						</tr>
					</table>
					<p>&nbsp;</p>
					<table>
						<tr>
							<td>
								<span data-i18n="melee-small"></span>
							</td>							
							<td>
								<input type="number" name="attr_skill-melee-small" />
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="melee-medium"></span>
							</td>							
							<td>
								<input type="number" name="attr_skill-melee-medium" />
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="melee-big"></span>
							</td>							
							<td>
								<input type="number" name="attr_skill-melee-big" />
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="pistols"></span>
							</td>							
							<td>
								<input type="number" name="attr_skill-pistols" />
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="rifles"></span>
							</td>							
							<td>
								<input type="number" name="attr_skill-rifles" />
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="heavy-weapons"></span>
							</td>							
							<td>
								<input type="number" name="attr_skill-heavy-weapons" />
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="melee-misc"></span>
							</td>							
							<td>
								<input type="number" name="attr_skill-melee-misc" />
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="ranged-misc"></span>
							</td>							
							<td>
								<input type="number" name="attr_skill-ranged-misc" />
							</td>
						</tr>
						<tr>
							<td>
								<span data-i18n="unarmed"></span>
							</td>							
							<td>
								<input type="number" name="attr_skill-unarmed" />
							</td>
						</tr>
					</table>
				</div>
				<div class="sheet-actor-advantages">
					<h1><span data-i18n="advantages-and-disadvantages"></span></h1>
					<fieldset class="repeating_actor-advantages-disadvantages">
					<div class="sheet-actor-advantage">
						<input type="text" name="attr_actor-advantage-name" value="">
						<textarea name="attr_actor-advantage-description" value=""></textarea>
					</div>
					</fieldset>
				</div>
				<div class="sheet-actor-movies">
					<h1><span data-i18n="movies"></span></h1>
					<fieldset class="repeating_actor-movies">
					<div class="sheet-actor-movies">
						<input type="text" name="attr_actor-movie-name" value="">
						<div class="sheet-radio-set">
							<input checked="checked" class="sheet-radiobox sheet-reset" type="radio" name="attr_movie-award" value="0">
							<input class="sheet-radiobox" type="radio" name="attr_movie-award" value="1">
							<input class="sheet-radiobox" type="radio" name="attr_movie-award" value="2">
							<input class="sheet-radiobox" type="radio" name="attr_movie-award" value="3">
							<input class="sheet-radiobox" type="radio" name="attr_movie-award" value="4">
							<input class="sheet-radiobox" type="radio" name="attr_movie-award" value="5">
						</div>
					</div>
					</fieldset>
				</div>
				<div class="sheet-actor-martialarts">
					<h1><span data-i18n="martialarts"></span></h1>
					<fieldset class="repeating_actor-martialarts">
					<div class="sheet-actor-martialarts">
						<input type="text" name="attr_actor-martialarts-name" value="">
						<div class="sheet-radio-set">
							<input checked="checked" class="sheet-radiobox sheet-reset" type="radio" name="attr_actor-martialarts-level" value="0">
							<input class="sheet-radiobox" type="radio" name="attr_actor-martialarts-level" value="1">
							<input class="sheet-radiobox" type="radio" name="attr_actor-martialarts-level" value="2">
							<input class="sheet-radiobox" type="radio" name="attr_actor-martialarts-level" value="3">
							<input class="sheet-radiobox" type="radio" name="attr_actor-martialarts-level" value="4">
							<input class="sheet-radiobox" type="radio" name="attr_actor-martialarts-level" value="5">
						</div>	
						<textarea name="attr_actor-martialarts-description" value=""></textarea>
					</div>
					</fieldset>
				</div>
				<div class="sheet-actor-awards">
					<h1><span data-i18n="awards"></span></h1>
					<textarea name="attr_actor-awards" value=""></textarea>
				</div>
				<div class="sheet-actor-misc">
					<h1><span data-i18n="misc"></span></h1>
					<textarea name="attr_actor-misc" value=""></textarea>
				</div>
			</div>			
		</div>
		<div class="sheet-role">
			<p><span data-i18n="role-name"></span><input type="text" name="attr_role-name" value=""></p>
			<p><span data-i18n="movieplot"></span><textarea name="attr_movieplot" value=""></textarea></p>
			<p><span data-i18n="role-description"></span><textarea name="attr_role-description" value=""></textarea></p>
			<p><span data-i18n="role-inventory"></span><textarea name="attr_role-inventory" value=""></textarea></p>
			<p><span data-i18n="role-weapons"></span>Coming soon</p>
			<div class="sheet-role-skills">
				<p><span data-i18n="role-skills"></span>Coming soon</p>
			</div>
			<div class="sheet-role-advantages">
				<p><span data-i18n="role-skills"></span>Coming soon</p>
			</div>
		</div>		
	</div>
	<div class="sheet-footer">
		Created by Gorthian | Supported by Hitdice | Copyright by Black Mask Verlag
		<br/>More Infos: https://github.com/Gorthian/Roll20_NHKS_CharacterSheet
	</div>	
</div>


<!-- SheetWorker //-->
<script type="text/worker">
	
	/* Globale Variablen -- Start */
	const iMinAttributeValue = 5;
	const iMaxAttributeValue = 10;
	const iMinSkillValue = 0;
	const iMaxSkillValue = 0;
	const aActorAttributes = ["strength","stamina","dexterity","knowledge","coolness","chi"];
	const aActorSkills = ["acrobatic","athletic","dodge","boats","persuade","computers","firstaid","extremesport","slideofhand","aircrafts","vehicles","improvisation","climbing","contacts","mechanic","stealth","perception","languages","searching","hiding"];
	const aActorWeaponSkills = ["melee-small","melee-medium","melee-big","pistols","rifles","heavy-weapons","melee-misc","ranged-misc","unarmed"];
	/* Globale Variablen -- Ende */
	
	/* Tab-Wechsel */
	const aButtonlist = ["actor","role"];
    aButtonlist.forEach(sButton => {
        on(`clicked:${sButton}`, function() {
            setAttrs({
                sheetTab: sButton
            });
        });
    });
	
	/* Event-Listener -- Start */
	on("sheet:opened", function () {
		recalcValues();
	});
	
	/* Änderungen an Attributen */
	aActorAttributes.forEach(sAttribute => {
        on(`change:${sAttribute}`, function() {
			console.log("[CHANGE] " + sAttribute);
            changedAttribute(sAttribute);
        });
    });	
	/* Event-Listener -- Ende */	
		
	/* Funktionen -- Start */
	function recalcValues() {
		console.log("[recalcValues]");
		aActorAttributes.forEach(sAttribute => {
			changedAttribute(sAttribute);
		});
		aActorSkills.forEach(sSkill => {
			changedSkill(sSkill);
		});
		aActorWeaponSkills.forEach(sSkill => {
			changedSkill(sSkill);
		});
	}
	
	function changedAttribute(sAttribute) {
		console.log("[changedAttribute] " + sAttribute);
		
		getAttrs([sAttribute], function (values){
			let iAttribute = parseInt(values[sAttribute]||iMinAttributeValue);
			let aAttributes = {};
			
			// Auf Min/Max prüfen
			if (iAttribute < iMinAttributeValue ) {
				iAttribute = iMinAttributeValue;
			} else if (iAttribute > iMaxAttributeValue ) {
				iAttribute = iMaxAttributeValue;
			}
			aAttributes[sAttribute] = iAttribute;
			setAttrs(aAttributes);
			
			switch (sAttribute) {
				case "strength":
					recalcMeleeAttack();
					recalcMeleeDefense();
					break;
				case "stamina":
					recalcHitpoints();
					break;
				case "dexterity":
					recalcMeleeDefense();
					recalcRangedAttack();
					break;
				case "knowledge":
					//nothing
					break;
				case "coolness":
					recalcInitiative();
					break;
				case "chi":
					recalcMeleeAttack();
					recalcChipoints();
					recalcMeleeDefense();
					recalcRangedAttack();
					break;
				default:
			}			
		});
	}
	
	function changedSkill(sSkill) {
		console.log("[changedSkill] " + sSkill);
		
		getAttrs(["skill-" + sSkill], function (values){
			let iSkill = parseInt(values["skill-" + sSkill]||iMinSkillValue);
			let aAttributes = {};
			
			// Auf Min/Max prüfen
			if (iSkill < iMinSkillValue ) {
				iSkill = iMinSkillValue;
			} else if (iSkill > iMaxSkillValue ) {
				iSkill = iMaxSkillValue;
			}
			aAttributes["skill-" + sSkill] = iSkill;
			setAttrs(aAttributes);			
		});
	}
	
	function recalcInitiative() {
		console.log("[recalcInitiative]");
		getAttrs(["coolness"], function (values){
			let iCoolness = parseInt(values["coolness"]||0);
			let iInitiative = iCoolness;
			let aAttributes = {};
			
			aAttributes["initiative"] = iInitiative;
			
			setAttrs(aAttributes);		
		});
	}
	
	function recalcHitpoints() {
		console.log("[recalcHitpoints]");
		getAttrs(["stamina"], function (values){
			let iStamina = parseInt(values["stamina"]||0);
			let iHitpoints = (iStamina + 4) * 10;
			let aAttributes = {};
			
			aAttributes["hitpoints_max"] = iHitpoints;
			
			setAttrs(aAttributes);		
		});
	}
	
	function recalcChipoints() {
		console.log("[recalcChipoints]");
		getAttrs(["chi"], function (values){
			let iChi = parseInt(values["chi"]||0);
			let iChipoints = iChi * 10;
			let aAttributes = {};
			
			aAttributes["chipoints_max"] = iChipoints;
			
			setAttrs(aAttributes);		
		});
	}
	
	function recalcMeleeAttack() {
		console.log("[recalcMeleeAttack]");
		getAttrs(["chi","strength"], function (values){
			let iChi = parseInt(values["chi"]||0);
			let iStrength = parseInt(values["strength"]||0);
			let iMeleeAttack = Math.round((iStrength * 2 + iChi) / 3);
			let aAttributes = {};
			
			aAttributes["melee-attack"] = iMeleeAttack;
			
			setAttrs(aAttributes);		
		});
	}
	
	function recalcMeleeDefense() {
		console.log("[recalcMeleeDefense]");
		getAttrs(["chi","strength","dexterity"], function (values){
			let iChi = parseInt(values["chi"]||0);
			let iStrength = parseInt(values["strength"]||0);
			let iDexterity = parseInt(values["dexterity"]||0);
			let iMeleeDefense = Math.round((iStrength + iDexterity + iChi) / 3);
			let aAttributes = {};
			
			aAttributes["melee-defense"] = iMeleeDefense;
			
			setAttrs(aAttributes);		
		});
	}
	
	function recalcRangedAttack() {
		console.log("[recalcRangedAttack]");
		getAttrs(["chi","dexterity"], function (values){
			let iChi = parseInt(values["chi"]||0);
			let iDexterity = parseInt(values["dexterity"]||0);
			let iRangedAttack = Math.round((iDexterity * 2 + iChi) / 3);
			let aAttributes = {};
			
			aAttributes["ranged-attack"] = iRangedAttack;
			
			setAttrs(aAttributes);		
		});
	}	
	/* Funktionen -- Ende */
</script>